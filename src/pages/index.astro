---
import '@/styles/globals.css'
import Layout from '../layouts/Layout.astro';
import { Button } from '@/components/ui/button';
import { Image } from 'astro:assets';
import myImage from '../../public/diego_.png'
import Message from '../components/Message.astro'
import IconList  from '../components/IconList.jsx'
import Socials from '../components/Socials.astro'
import RecentProjects from '@/components/RecentProjects.jsx';
import MouseAnimation from '@/components/MouseAnimation.astro';
---
<script>
  import { animate, stagger, scroll, timeline } from "motion"

  scroll(animate(
  ".recent-projects",
  { opacity: [0.1,1] },
  { duration: 4,
    opacity: { duration: 4 },
    easing: ["ease-in", "ease-out"]
  }
))
  animate(".mouse_scroll", { scale: 1.3 })

  scroll(animate(
    ".mouse_scroll",
    { opacity: [1,0] },
    { duration: 4,
      opacity: { duration: 4 },
      easing: ["ease-in", "ease-out"]
    }
  ))


  const sequence = [
    [".hero", { x: ["-200%", "0%"] }, { duration: 0.5 }],
    [".utils .tech", { x: ["200%", "0%"] }, { at: "+0.1" }],
    [".utils .socials", { x: ["200%", "0%"] }, { at: "+0.1"}],
    [".utils .message", { x: ["200%", "0%"] }, { at: "+0.1"}],
    [".recent-projects", { y: ["1000%", "0%"] }, { at: "+0.1"}],
    [".mouse_scroll", { y: ["-1000%", "0%"] }, { at: "+0.1"}],
  ]

  timeline(sequence)

</script>


<script is:inline>
  const getThemePreferences = () => {
    if (typeof localStorage !== undefined && localStorage.getItem('theme')) {
      return localStorage.getItem('theme')
    }
    return window.matchMedia('(prefers-color.scheme: dark)').matches ? 'dark' : 'light'
  }

  const isDark = getThemePreferences() === 'dark'
  document.documentElement.classList['isDark' ? 'add' : 'remove']('dark')

  if (typeof localStorage !== 'undefined') {
    const observer = new MutationObserver(() => {
      const isDark = document.documentElement.classList.contains('dark')
      localStorage.setItem('theme', isDark ? 'dark' : 'light')
    })
    observer.observe(document.documentElement, { attributes: true, attributeFilter: ['class'] })
  }
</script>

<Layout>
  <div class="main flex flex-col gap-4 mb-20">
    <div class="container flex flex-col lg:flex-row lg:justify-around gap-4">
      <div class="hero lg:w-2/3 lg:py-20 lg:px-20 w-100 flex justify-center bg-card rounded-xl text-card-foreground shadow-lg box-border">
        <div class="land-intro lg:w-2/3 text-center lg:text-left">
          <h1 class="text-3xl lg:text-7xl font-extrabold">Full Stack Developer</h1>
          <div class="pt-3">
            <p class="text-xl lg:text-3xl">I'm a problem solver that loves to learn new things</p>
          </div>
          <div class="my-8">
            <Button className="lg:text-2xl font-bold lg:py-7">
              See my work
            </Button>
          </div>
        </div>
        <div class="land-image lg:w-1/3 lg:flex hidden items-center justify-end content-center">
          <Image src={myImage} alt="diego_profile_img" class="w-80 h-auto rounded-lg shadow"/>
        </div>
      </div>
      <div class="utils lg:w-1/3 flex flex-col gap-4 lg:justify-between">
        <div class="tech lg:h-1/3 bg-card rounded-xl text-card-foreground shadow-lg box-border flex flex-col justify-center items-center text-2xl lg:text-2xl w-full font-extrabold">
          Tech Stack
          <IconList client:only/>
        </div>
        <div class="socials lg:h-1/3 bg-card rounded-xl text-card-foreground shadow-lg box-border flex flex-col justify-center items-center">
          <Socials/>
        </div>
        <div class="message lg:h-1/3 bg-card rounded-xl text-card-foreground shadow-lg box-border flex justify-center items-center">
          <Message />
        </div>
      </div>
    </div>
    <MouseAnimation />
    <RecentProjects/>
  </div>
</Layout>
